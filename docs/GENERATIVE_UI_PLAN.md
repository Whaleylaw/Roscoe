# Generative UI Plan for Roscoe Paralegal Agent

## 1. Executive Summary

This document outlines the architecture and implementation plan for a **Generative UI** (GenUI) for the Roscoe Paralegal Agent. The goal is to move beyond simple text-based chat and provide a rich, interactive interface where the agent can render specialized components (calendars, document editors, video players) on demand, tailored to the specific legal task at hand.

## 2. Technology Stack Selection

To achieve "Generative UI" where the server (Agent) determines what UI to render at runtime, we recommend the following stack. This is currently the industry standard for high-fidelity AI interfaces.

*   **Frontend Framework:** **Next.js (App Router)**
    *   *Why:* Supports **React Server Components (RSC)**, which are critical for streaming UI from the agent to the client.
*   **AI Integration:** **Vercel AI SDK (`ai/rsc`)**
    *   *Why:* Provides the `streamUI` function. This allows the LLM to "call a tool" that, instead of returning text, returns a fully rendered React component to the user.
*   **UI Component Library:** **shadcn/ui** + **Tailwind CSS**
    *   *Why:* Modular, copy-paste components that are highly customizable. Gives a professional "legal software" look out of the box.
*   **State Management:** **React Server Actions** + **Zustand** (for client-side complex state like the document editor).
*   **Document Editor:** **TipTap** or **Lexical**
    *   *Why:* Headless rich text editors that support "Track Changes," comments, and collaborative editingâ€”essential for legal drafting.

---

## 3. Core Architecture: The "StreamUI" Pattern

Instead of the traditional "Chatbot" loop (Text Request -> Text Response), we use a **Generative Loop**:

1.  **User Intent:** "Show me the timeline for the Wilson case."
2.  **Agent Decision:** The LLM decides to call the `display_timeline` tool.
3.  **Server Execution:**
    *   The tool fetches data (e.g., from Supabase or `analyze_audio` results).
    *   The tool *returns* a `<TimelineComponent data={...} />` React component.
4.  **Client Render:** The user sees an interactive timeline instantly, not a text description.

---

## 4. Component Catalog (The "Paralegal Toolkit")

We will build a library of "Generative Components" that the Agent can summon.

### A. Case Management & Dashboard
*   **`CaseDashboard`**: High-level view of a case.
    *   *Features:* Client info card, status milestones (ProgressBar), recent activity feed.
    *   *Agent Trigger:* "Summarize the Wilson case."

### B. Document & Artifact Creation
*   **`InteractiveDocument` (The "Canvas")**:
    *   *Tech:* TipTap editor.
    *   *Features:*
        *   **Generative Drafting:** Agent streams text directly into the editor.
        *   **Track Changes:** AI edits appear as suggestions (Red/Green highlights) for attorney review.
        *   **Citation Linking:** Text links that open a side-panel with the source law/exhibit.
    *   *Agent Trigger:* "Draft a demand letter." "Edit this motion to include the new witness statement."

### C. Multimedia Evidence
*   **`EvidenceViewer`**:
    *   *Tech:* React Player + Canvas overlays.
    *   *Features:*
        *   **Video:** Playback with *timestamped markers* (generated by `analyze_video`). Clicking a marker jumps to that frame.
        *   **Image:** Zoom/Pan viewer with bounding box annotations (generated by `analyze_image`).
    *   *Agent Trigger:* "Show me the accident scene photos." "Review the bodycam footage."

### D. Legal Research & Exhibits
*   **`ExhibitGallery`**: Grid view of images/documents with metadata (Exhibit A, B, C labels).
    *   *Agent Trigger:* "Generate trial exhibits from these files."
*   **`ResearchCard`**: A citation card showing Case Law summaries, relevance scores, and links to full text.
    *   *Agent Trigger:* "Research comparative negligence in KY."

### E. Productivity & Task Management
*   **`SmartCalendar`**:
    *   *Tech:* `react-big-calendar` or FullCalendar.
    *   *Features:* Displays deadlines, court dates, and statutes of limitations. Interactive (drag-and-drop).
    *   *Agent Trigger:* "When is the answer due?" "Show my schedule for next week."
*   **`TaskKanban`**:
    *   *Features:* Columns for "To Do", "In Progress", "Review".
    *   *Agent Trigger:* "What tasks are left for discovery?"

---

## 5. Implementation Roadmap

### Phase 1: Foundation (Next.js + AI SDK)
1.  Initialize Next.js project with `ai` SDK.
2.  Set up the `streamUI` server action handler.
3.  Create the base `ChatMessage` component that can render generic React nodes.

### Phase 2: The Editor (Document Core)
1.  Implement **TipTap** editor.
2.  Build the "Track Changes" plugin (critical for legal trust).
3.  Connect Agent to "Insert Block" / "Suggest Edit" tools.

### Phase 3: Evidence & Multimedia
1.  Build `EvidenceViewer` component.
2.  Update `analyze_video` and `analyze_image` tools in Python to return *structured JSON* (timestamps, boxes) instead of just text, so the UI can render markers.

### Phase 4: Dashboards & Calendar
1.  Implement `CaseDashboard` and `SmartCalendar` components.
2.  Connect to Supabase data sources.

---

## 6. Comparison with Alternatives

For a detailed analysis of **Thesys**, **CopilotKit**, and **Ag-UI**, please see `docs/GENERATIVE_UI_STRATEGY_AND_COMPARISON.md`.

**Summary Recommendation:**
*   **Vercel AI SDK** is the clear winner for robust, custom "Generative UI" infrastructure.
*   **CopilotKit** is a strong alternative specifically for embedding AI into *existing* text areas if the full Generative UI build is too heavy.
*   **Thesys/Ag-UI** are not recommended for production use at this stage.

---

## 7. Why This "Best" Approach?

*   **Trust:** Lawyers don't trust "black box" text. They trust documents they can redline. The **Interactive Editor** with Track Changes is the killer feature.
*   **Efficiency:** Instead of reading "At 00:15 the car turns left", they *see* a marker on the video timeline at 00:15.
*   **Flexibility:** The Agent can "invent" new interfaces by combining these components (e.g., a Split View with Document on left, Video on right).
